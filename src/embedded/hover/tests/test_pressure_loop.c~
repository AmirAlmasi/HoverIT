#include <check.h>
#include "../src/pressure_loop.h"
#include "../src/pressure_sensor.h"
#include <stdlib.h>

START_TEST(test){
  float gap = get_gap();
  int value = handle_pressure(gap);
  if(gap<-10 && value!=-1){
    fail("the value must be -1!");
  }
  if(gap>10 && value!=1){
    fail("the value must be 1!");
  }
  if((gap>=-10 && gap<=10) && value!=0){
    fail("the value must be 0!");
  }

}END_TEST

START_TEST(test_positive){
  int value = handle_pressure(get_positive());
  fail_unless(value==1,"1 should be returned!");
}END_TEST

START_TEST(test_negative){
  int value = handle_pressure(get_negative());
  fail_unless(value==-1,"-1 should be returned!");
}END_TEST

START_TEST(test_equal){
  int value = handle_pressure(get_equal());
  fail_unless(value==0,"0 should be returned!");
}END_TEST

Suite * new_suite(void){
  Suite *s = suite_create("NEW SUITE");
  TCase *tc = tcase_create("NEW Test Case");
  tcase_add_test(tc,test);
  tcase_add_test(tc,test_positive);
  tcase_add_test(tc,test_negative);
  tcase_add_test(tc,test_equal);
  suite_add_tcase(s,tc);
  return s;
}

